<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Who Are You?</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Welcome Screen -->
    <div id="welcome-screen" class="screen active">
        <div class="container welcome-container">
            <h1 class="title">Who Are You?</h1>
            <p class="subtitle">Deepen your connection through meaningful questions</p>
            <div class="mode-buttons">
                <button onclick="showCreateGame()" class="mode-btn">
                    <h3>Create Game</h3>
                    <p>Choose relationship type and get a game code</p>
                </button>
                <button onclick="showJoinGame()" class="mode-btn">
                    <h3>Join Game</h3>
                    <p>Enter a game code to join</p>
                </button>
            </div>
        </div>
    </div>

    <!-- Relationship Selection Screen -->
    <div id="relationship-screen" class="screen">
        <div class="container">
            <button onclick="showScreen('welcome-screen')" class="back-btn">← Back</button>
            <h2 class="screen-title">Choose Your Relationship</h2>
            <p class="screen-subtitle">Select the relationship type that best describes you</p>
            <div id="relationship-categories" class="relationship-categories">
                <!-- Family Relationships -->
                <div class="category-dropdown">
                    <button class="category-header" onclick="toggleCategory('family')">
                        <span>Family</span>
                        <span class="dropdown-icon">▼</span>
                    </button>
                    <div class="category-content" data-category="family">
                        <div class="relationship-grid">
                            <button onclick="selectRelationship('brother-brother', this)" class="relationship-btn">Brother & Brother</button>
                            <button onclick="selectRelationship('sister-sister', this)" class="relationship-btn">Sister & Sister</button>
                            <button onclick="selectRelationship('brother-sister', this)" class="relationship-btn">Brother & Sister</button>
                            <button onclick="selectRelationship('mother-son', this)" class="relationship-btn">Mother & Son</button>
                            <button onclick="selectRelationship('mother-daughter', this)" class="relationship-btn">Mother & Daughter</button>
                            <button onclick="selectRelationship('father-son', this)" class="relationship-btn">Father & Son</button>
                            <button onclick="selectRelationship('father-daughter', this)" class="relationship-btn">Father & Daughter</button>
                            <button onclick="selectRelationship('grandfather-grandson', this)" class="relationship-btn">Grandfather & Grandson</button>
                            <button onclick="selectRelationship('grandfather-granddaughter', this)" class="relationship-btn">Grandfather & Granddaughter</button>
                            <button onclick="selectRelationship('grandmother-grandson', this)" class="relationship-btn">Grandmother & Grandson</button>
                            <button onclick="selectRelationship('grandmother-granddaughter', this)" class="relationship-btn">Grandmother & Granddaughter</button>
                            <button onclick="selectRelationship('male-cousins', this)" class="relationship-btn">Male Cousins</button>
                            <button onclick="selectRelationship('female-cousins', this)" class="relationship-btn">Female Cousins</button>
                            <button onclick="selectRelationship('mixed-cousins', this)" class="relationship-btn">Male & Female Cousins</button>
                        </div>
                    </div>
                </div>

                <!-- Romantic Relationships -->
                <div class="category-dropdown">
                    <button class="category-header" onclick="toggleCategory('romantic')">
                        <span>Romantic</span>
                        <span class="dropdown-icon">▼</span>
                    </button>
                    <div class="category-content" data-category="romantic">
                        <div class="relationship-grid">
                            <button onclick="selectRelationship('new-dating', this)" class="relationship-btn">New Dating Couple</button>
                            <button onclick="selectRelationship('long-term-partners', this)" class="relationship-btn">Long-term Partners</button>
                            <button onclick="selectRelationship('engaged', this)" class="relationship-btn">Engaged Couple</button>
                            <button onclick="selectRelationship('married', this)" class="relationship-btn">Married Couple</button>
                        </div>
                    </div>
                </div>

                <!-- Friends -->
                <div class="category-dropdown">
                    <button class="category-header" onclick="toggleCategory('friends')">
                        <span>Friends</span>
                        <span class="dropdown-icon">▼</span>
                    </button>
                    <div class="category-content" data-category="friends">
                        <div class="relationship-grid">
                            <button onclick="selectRelationship('best-friends-same', this)" class="relationship-btn">Best Friends (Same Gender)</button>
                            <button onclick="selectRelationship('best-friends-different', this)" class="relationship-btn">Best Friends (Different Gender)</button>
                            <button onclick="selectRelationship('new-friends', this)" class="relationship-btn">New Friends</button>
                            <button onclick="selectRelationship('childhood-friends', this)" class="relationship-btn">Childhood Friends Reconnecting</button>
                            <button onclick="selectRelationship('work-friends', this)" class="relationship-btn">Work Friends</button>
                            <button onclick="selectRelationship('online-friends', this)" class="relationship-btn">Online Friends Meeting IRL</button>
                        </div>
                    </div>
                </div>

                <!-- Other -->
                <div class="category-dropdown">
                    <button class="category-header" onclick="toggleCategory('other')">
                        <span>Other</span>
                        <span class="dropdown-icon">▼</span>
                    </button>
                    <div class="category-content" data-category="other">
                        <div class="relationship-grid">
                            <button onclick="selectRelationship('colleagues', this)" class="relationship-btn">Colleagues</button>
                            <button onclick="selectRelationship('mentor-mentee', this)" class="relationship-btn">Mentor & Mentee</button>
                            <button onclick="selectRelationship('roommates', this)" class="relationship-btn">Roommates</button>
                            <button onclick="selectRelationship('neighbors', this)" class="relationship-btn">Neighbors</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- Join Game Screen -->
    <div id="join-screen" class="screen">
        <div class="container">
            <button onclick="showScreen('welcome-screen')" class="back-btn">← Back</button>
            <h2 class="screen-title">Join Game</h2>
            <p class="screen-subtitle">Enter the game code shared by the host</p>
            
            <div class="join-room-input">
                <input type="text" id="room-code-input" placeholder="Enter game code" maxlength="7">
                <button onclick="joinGameRoom()" class="main-btn">Join Game</button>
            </div>
        </div>
    </div>

    <!-- Room Lobby Screen -->
    <div id="lobby-screen" class="screen">
        <div class="container">
            <div id="lobby-info" style="display: none;">
                <div id="room-info">
                    <p class="code-label">Game Code</p>
                    <div class="code-box">
                        <span id="room-code-display" class="room-code"></span>
                    </div>
                </div>

                <div class="player-inputs">
                    <div class="input-group">
                        <label for="your-name">Your Name</label>
                        <input type="text" id="your-name" placeholder="Enter your name">
                    </div>
                </div>

                <div class="status-container">
                    <div class="status-dot"></div>
                    <p id="lobby-status">Waiting...</p>
                </div>

                <button id="start-online-game" onclick="startOnlineGame()" class="main-btn" disabled>
                    <span>Begin Journey</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Player Setup Screen -->
    <div id="setup-screen" class="screen">
        <div class="container">
            <h2 class="screen-title">Player Setup</h2>
            <div class="player-inputs">
                <div class="input-group">
                    <label for="player1-name">Player 1 Name:</label>
                    <input type="text" id="player1-name" placeholder="Enter your name">
                </div>
                <div class="input-group">
                    <label for="player2-name">Player 2 Name:</label>
                    <input type="text" id="player2-name" placeholder="Enter your name">
                </div>
            </div>
            <button onclick="startGame()" class="main-btn">Begin Journey</button>
        </div>
    </div>

    <!-- Game Screen -->
    <div id="game-screen" class="screen">
        <div class="container">
            <!-- Round Info - Hidden for cleaner UI -->
            <div id="round-header" class="round-header" style="display: none;">
                <h2 id="round-title">Round 1 - Getting Started</h2>
                <p id="round-subtitle">Choose a category and draw a question</p>
            </div>

            <!-- Progress Bar -->
            <div class="progress-container">
                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill"></div>
                </div>
                <p class="progress-text"><span id="current-round-num">1</span> of 5 rounds</p>
            </div>

            <!-- Current Turn Info -->
            <div id="turn-info" class="turn-info">
                <p id="current-turn" class="turn-text">Player 1's turn to choose and ask</p>
            </div>

            <!-- Category Selection -->
            <div id="category-selection" class="category-selection">
                <h3>Pick a topic:</h3>
                <div id="categories-container" class="categories-container">
                    <!-- Categories will be populated by JavaScript -->
                </div>
            </div>

            <!-- Question Display -->
            <div id="question-display" class="question-display hidden">
                <div class="card">
                    <h3 id="question-category">Category</h3>
                    <p id="question-text">Question will appear here</p>
                </div>
                <div class="question-actions">
                    <button onclick="saveQuestion()" class="secondary-btn" id="save-question-btn">
                        <span class="heart-icon">♡</span> Save Question
                    </button>
                    <button onclick="nextTurn()" class="main-btn">Answer Complete</button>
                </div>
            </div>

            <!-- Waiting/Answering State -->
            <div id="waiting-state" class="waiting-state hidden">
                <div class="waiting-card">
                    <h3 id="waiting-title">Listening & Answering</h3>
                    <p id="waiting-message">Wait for the other player to ask their question, then share your answer!</p>
                    <div class="waiting-animation">
                        <div class="pulse-dot"></div>
                        <div class="pulse-dot"></div>
                        <div class="pulse-dot"></div>
                    </div>
                </div>
            </div>

            <!-- Round Complete -->
            <div id="round-complete" class="round-complete hidden">
                <h3>Round Complete!</h3>
                <p>Ready for the next round?</p>
                <button onclick="nextRound()" class="main-btn">
                    <span>Continue</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Round Announcement Overlay -->
    <div id="round-announcement" class="round-announcement">
        <div class="round-announcement-content">
            <h1 id="announcement-title" class="round-announcement-title">Round 1</h1>
            <p id="announcement-subtitle" class="round-announcement-subtitle">Getting Started</p>
        </div>
    </div>

    <!-- Game Complete Screen -->
    <div id="complete-screen" class="screen">
        <div class="container">
            <div id="complete-content" style="display: none;">
                <h2 class="complete-title">Journey Complete!</h2>
                <p class="complete-message">You've shared meaningful moments and deepened your connection</p>

                <div id="saved-questions-summary" class="saved-summary">
                    <!-- Will be populated by JavaScript if questions were saved -->
                </div>

                <div class="complete-actions">
                    <button onclick="shareExperience()" class="secondary-btn">Share Your Journey</button>
                    <button onclick="restartGame()" class="main-btn">Start New Journey</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
    
    <!-- Scripts -->
    <script src="config.js"></script>
    <script src="questions.js"></script>
    <script src="script.js"></script>
</body>
</html>